import{r as c,j as e,A as G,e as C,f as K,l as m,J as q,E as J,M as Q,C as a,b as r,c as l,N as X,d as t,u as Y,o as Z,q as ee,s as x,t as h,B as o,O as se,P as ie,h as p,k as ae,v as te,S as ce,Q as ne,x as re}from"./index-DtNahLzf.js";import{w as u,d as j}from"./api-CnfHayjd.js";import{t as g}from"./index-BR4xEgPS.js";import{L as le}from"./lock-20m6CtwN.js";function ue(){const[k,D]=c.useState([]),[L,I]=c.useState([]),[E,R]=c.useState([]),[T,F]=c.useState([]),[n,O]=c.useState(null),[M,B]=c.useState(!0),[f,N]=c.useState(null);c.useEffect(()=>{const s=async()=>{try{N(null);try{const v="http://localhost:8080/api",A={"Content-Type":"application/json"}}catch{console.log("⚠️ API server not available, using enhanced fallback data")}const d=[{id:"AUD-001",timestamp:new Date(Date.now()-1800*1e3).toISOString(),user:"alice.johnson@organizeit.com",action:"Resource Created",resource:"EC2 Instance i-1234567890abcdef0",service:"AWS EC2",ip:"192.168.1.100",userAgent:"AWS CLI/2.15.30",status:"Success",risk:"Low",details:"Created new EC2 instance in us-east-1"},{id:"AUD-002",timestamp:new Date(Date.now()-2.5*60*60*1e3).toISOString(),user:"bob.smith@organizeit.com",action:"Configuration Changed",resource:"Security Group sg-abcdef1234567890",service:"AWS VPC",ip:"192.168.1.101",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",status:"Success",risk:"Medium",details:"Added inbound rule for port 443"},{id:"AUD-003",timestamp:new Date(Date.now()-480*60*1e3).toISOString(),user:"System",action:"Automated Backup",resource:"RDS Database prod-db-001",service:"AWS RDS",ip:"Internal",userAgent:"AWS Service",status:"Success",risk:"Low",details:"Scheduled backup completed successfully"},{id:"AUD-004",timestamp:new Date(Date.now()-720*60*1e3).toISOString(),user:"carol.davis@organizeit.com",action:"Access Denied",resource:"IAM Role arn:aws:iam::123456789012:role/AdminRole",service:"AWS IAM",ip:"203.0.113.45",userAgent:"AWS Console",status:"Failed",risk:"High",details:"Insufficient permissions for role assumption"}];D(d),I([{name:"SOC 2 Type II",status:"Compliant",coverage:98,lastAudit:"2024-06-15",nextAudit:"2024-12-15",findings:2,critical:0},{name:"ISO 27001",status:"Compliant",coverage:96,lastAudit:"2024-05-20",nextAudit:"2024-11-20",findings:4,critical:1},{name:"GDPR",status:"Partial",coverage:87,lastAudit:"2024-04-10",nextAudit:"2024-10-10",findings:8,critical:2},{name:"HIPAA",status:"Compliant",coverage:94,lastAudit:"2024-03-25",nextAudit:"2024-09-25",findings:3,critical:0}]);const z=[{id:"BLK-001",hash:"0x7d4a8b9c2e1f3a5d9e8c7b6a4f2e1d9c8b7a6f5e4d3c2b1a",timestamp:new Date(Date.now()-1800*1e3).toISOString(),action:"Configuration Change",user:"alice.johnson@organizeit.com",verified:!0,confirmations:12},{id:"BLK-002",hash:"0x3c2b1a9f8e7d6c5b4a3f2e1d9c8b7a6f5e4d3c2b1a0f9e8d",timestamp:new Date(Date.now()-2.5*60*60*1e3).toISOString(),action:"Access Grant",user:"bob.smith@organizeit.com",verified:!0,confirmations:8}];R(z);const y=[{category:"Data Access",high:12,medium:28,low:145},{category:"Configuration Changes",high:8,medium:34,low:89},{category:"User Management",high:5,medium:15,low:67},{category:"System Operations",high:3,medium:22,low:234}];F(y);const S=d.length*600,_=y.reduce((v,A)=>v+A.high,0),$=Math.floor(S*.75);O({totalEvents:S,highRiskEvents:_,complianceScore:94,blockchainVerified:$})}catch(d){console.error("Error fetching audit trails data:",d),N(d.message)}finally{B(!1)}};s();const i=setInterval(s,12e4);return()=>clearInterval(i)},[]);const P=u(async()=>{try{const s={risk_levels:["High","Medium"],date_range:{start:new Date(Date.now()-6048e5).toISOString(),end:new Date().toISOString()}};await j.applyFilters(s),g.success("Audit log filters applied successfully")}catch(s){console.error("Failed to apply filters:",s)}}),U=u(async()=>{try{const s=await j.exportAuditLogs("csv",{start:new Date(Date.now()-2592e6).toISOString(),end:new Date().toISOString()});g.success(`Audit logs exported: ${s.file_size}`)}catch(s){console.error("Failed to export logs:",s)}}),H=u(async()=>{try{const s=await j.searchLogs("security configuration",{risk_levels:["High","Medium"]});g.success(`Found ${s.results_count} matching audit logs`)}catch(s){console.error("Failed to search logs:",s)}}),V=u(async s=>{try{const i=await j.getLogDetails(s);g.success("Audit log details retrieved"),console.log("Log details:",i.log_details)}catch(i){console.error("Failed to get log details:",i)}}),W=s=>{switch(s){case"Compliant":return"secondary";case"Partial":return"secondary";case"Non-Compliant":return"destructive";default:return"outline"}},w=s=>new Date(s).toLocaleString(),b=s=>new Date(s).toLocaleDateString();return M?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-64"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((s,i)=>e.jsx("div",{className:"h-32 bg-muted rounded"},i))}),e.jsx("div",{className:"h-64 bg-muted rounded"})]})}):f?e.jsx("div",{className:"p-6",children:e.jsxs(G,{className:"border-destructive/50 bg-destructive/5",children:[e.jsx(C,{className:"h-4 w-4"}),e.jsxs(K,{children:["Failed to load audit trails data: ",f,". Please check your connection and try again."]})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Audit Trails"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive audit logging and compliance tracking"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(m,{variant:"outline",onClick:P,children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Filter"]}),e.jsxs(m,{variant:"outline",onClick:U,children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Export"]}),e.jsxs(m,{onClick:H,children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Search Logs"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm",children:"Total Events"}),e.jsx(X,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(t,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:n?.totalEvents.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["+",Math.floor(n?.totalEvents*.005).toLocaleString()," today"]})]})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm",children:"High Risk Events"}),e.jsx(C,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(t,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:n?.highRiskEvents}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 24 hours"})]})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm",children:"Compliance Score"}),e.jsx(Y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(t,{children:[e.jsxs("div",{className:"text-2xl font-semibold",children:[n?.complianceScore,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all frameworks"})]})]}),e.jsxs(a,{children:[e.jsxs(r,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(l,{className:"text-sm",children:"Blockchain Verified"}),e.jsx(le,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(t,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:n?.blockchainVerified.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Math.round(n?.blockchainVerified/n?.totalEvents*100),"% of all events"]})]})]})]}),e.jsxs(Z,{defaultValue:"logs",className:"space-y-4",children:[e.jsxs(ee,{children:[e.jsx(x,{value:"logs",children:"Audit Logs"}),e.jsx(x,{value:"compliance",children:"Compliance"}),e.jsx(x,{value:"blockchain",children:"Blockchain Audit"}),e.jsx(x,{value:"analytics",children:"Risk Analytics"})]}),e.jsx(h,{value:"logs",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:k.map(s=>e.jsx(a,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium",children:s.action}),e.jsx(o,{variant:s.status==="Success"?"secondary":"destructive",children:s.status}),e.jsxs(o,{variant:s.risk==="High"?"destructive":s.risk==="Medium"?"secondary":"outline",children:[s.risk," Risk"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.details}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"User"}),e.jsx("div",{children:s.user})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Service"}),e.jsx("div",{children:s.service})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"IP Address"}),e.jsx("div",{children:s.ip})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Timestamp"}),e.jsx("div",{children:w(s.timestamp)})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(m,{size:"sm",variant:"outline",onClick:()=>V(s.id),children:e.jsx(se,{className:"w-4 h-4"})})})]})})},s.id))})}),e.jsx(h,{value:"compliance",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:L.map((s,i)=>e.jsx(a,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx(o,{variant:W(s.status),children:s.status}),s.critical>0&&e.jsxs(o,{variant:"destructive",children:[s.critical," Critical"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Coverage"}),e.jsxs("div",{children:[s.coverage,"%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Last Audit"}),e.jsx("div",{children:b(s.lastAudit)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Next Audit"}),e.jsx("div",{children:b(s.nextAudit)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Findings"}),e.jsxs("div",{children:[s.findings," total"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-semibold",children:[s.coverage,"%"]}),e.jsx(ie,{value:s.coverage,className:"w-20 mt-1"})]})]})})},i))})}),e.jsx(h,{value:"blockchain",className:"space-y-4",children:e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsx(l,{children:"Blockchain Audit Trail"}),e.jsx(p,{children:"Immutable audit records secured by blockchain technology"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:E.map(s=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium",children:s.action}),s.verified&&e.jsxs(o,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(ae,{className:"w-3 h-3"}),"Verified"]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.confirmations," confirmations"]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Hash:"})," ",s.hash]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"User:"})," ",s.user]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Timestamp:"})," ",w(s.timestamp)]})]})]},s.id))})})]})}),e.jsx(h,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsx(l,{children:"Risk Distribution"}),e.jsx(p,{children:"Event risk levels by category"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:T.map((s,i)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:s.category}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.high+s.medium+s.low," total"]})]}),e.jsxs("div",{className:"flex h-2 rounded-full overflow-hidden",children:[e.jsx("div",{className:"bg-red-500",style:{width:`${s.high/(s.high+s.medium+s.low)*100}%`}}),e.jsx("div",{className:"bg-yellow-500",style:{width:`${s.medium/(s.high+s.medium+s.low)*100}%`}}),e.jsx("div",{className:"bg-green-500",style:{width:`${s.low/(s.high+s.medium+s.low)*100}%`}})]}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["High: ",s.high]}),e.jsxs("span",{children:["Medium: ",s.medium]}),e.jsxs("span",{children:["Low: ",s.low]})]})]},i))})})]}),e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsx(l,{children:"Audit Summary"}),e.jsx(p,{children:"Key audit metrics and insights"})]}),e.jsxs(t,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(te,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Data Integrity"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"99.97% of audit logs verified and tamper-proof"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ce,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"font-medium",children:"System Coverage"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"342 services actively monitored across all environments"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ne,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"User Activity"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"1,247 active users with comprehensive activity tracking"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(re,{className:"w-4 h-4 text-orange-600"}),e.jsx("span",{className:"font-medium",children:"Retention Policy"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"7-year retention with automated archival"})]})]})]})]})})]})]})}export{ue as AuditTrails};
