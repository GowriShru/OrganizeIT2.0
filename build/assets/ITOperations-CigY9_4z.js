import{r as c,j as e,A as H,e as U,f as F,l as b,C as o,b as d,c as m,x as te,d as h,n as ae,k as re,o as ne,q as ie,s as S,t as k,h as g,P as C,v as ce,B as T,T as le}from"./index-DtNahLzf.js";import{o as D}from"./api-CnfHayjd.js";import{t as y}from"./index-BR4xEgPS.js";import{R as N}from"./rotate-ccw-TK-3Ba20.js";import{R as K,C as L,X as O,Y as _}from"./generateCategoricalChart-BVheJlJJ.js";import{A as oe,a as z}from"./AreaChart-TKF-TF37.js";import{C as de,H as me,N as he}from"./network-bGIkEeYD.js";import{L as xe,a as M}from"./LineChart-IU27-owU.js";const ue=()=>{const i=[],A=Date.now();for(let j=23;j>=0;j--){const w=A-j*60*60*1e3,x=new Date(w).getHours(),p=x>=9&&x<=17?70:40;i.push({timestamp:new Date(w).toISOString(),time:String(x).padStart(2,"0")+":00",cpu:Math.max(20,Math.min(95,p+(Math.random()-.5)*30)),memory:Math.max(30,Math.min(90,p+(Math.random()-.5)*25)),disk:Math.max(10,Math.min(80,p*.6+(Math.random()-.5)*20)),network:Math.max(5,Math.min(70,p*.4+(Math.random()-.5)*15))})}return i};function be(){const[i,A]=c.useState(null),[j,w]=c.useState([]),[x,p]=c.useState([]),[E,V]=c.useState([]),[B,X]=c.useState(!0),[P,$]=c.useState(null),[u,Y]=c.useState({cpu:0,memory:0,storage:0,network:0}),[I,R]=c.useState(!1),[l,f]=c.useState(new Set);c.useEffect(()=>{v();const s=setInterval(v,6e4);return()=>clearInterval(s)},[]);const v=async()=>{try{$(null);let s={services:[{id:"SVC-001",name:"Web Frontend",status:"healthy",uptime:99.98,response_time:245},{id:"SVC-002",name:"User API",status:"healthy",uptime:99.95,response_time:189},{id:"SVC-003",name:"Payment API",status:"degraded",uptime:98.2,response_time:1200}],alerts:[{id:"ALT-001",severity:"High",title:"Database Connection Pool Exhaustion",description:"Payment processing database showing connection pool exhaustion.",service:"Payment API",timestamp:new Date(Date.now()-2.5*60*60*1e3).toISOString(),status:"Active"}],performance:ue()};try{const a="http://localhost:8080/api",t={"Content-Type":"application/json"},r=await fetch(`${a}/operations`,{headers:t});r.ok?(s=(await r.json()).data,console.log("✓ Successfully fetched operations data from API server")):console.log("⚠️ API server not responding, using fallback operations data")}catch{console.log("⚠️ API server not available for operations data, using fallback. Start server with: npm run server")}if(A({mttd:8.2,mttr:24.5,uptime:99.87,alerts_count:s.alerts?.length||0}),s.performance&&s.performance.length>0){const a=s.performance.filter((r,n)=>n%4===0).slice(0,6);w(a);const t=s.performance[s.performance.length-1];Y({cpu:Math.round(t.cpu),memory:Math.round(t.memory),storage:Math.round(t.disk),network:Math.round(t.network)})}if(s.alerts){const a=s.alerts.map(t=>({id:t.id,title:t.title,severity:t.severity,status:t.status,created:q(t.timestamp),service:t.service}));p(a)}if(s.services){const a=s.services.map(t=>({name:t.name,status:t.status,uptime:`${t.uptime?.toFixed(2)||"99.5"}%`,responseTime:`${t.response_time||"245"}ms`}));V(a)}}catch(s){console.error("Error fetching operations data:",s),$(s.message)}finally{X(!1)}},q=s=>{const a=new Date,t=new Date(s),r=a.getTime()-t.getTime(),n=Math.floor(r/(1e3*60*60)),se=Math.floor(r/(1e3*60));return n>0?`${n} hours ago`:`${se} minutes ago`},G=async()=>{R(!0);try{await new Promise(s=>setTimeout(s,2e3)),y.success("Health check completed successfully"),v()}catch{y.error("Health check failed")}finally{R(!1)}},W=async(s,a)=>{const t=`restart-${s}`;if(!l.has(t)){f(r=>new Set(r).add(t));try{await D.restartService(s),setTimeout(v,2e3)}catch{y.error(`Failed to restart ${a}`)}finally{f(r=>{const n=new Set(r);return n.delete(t),n})}}},J=async(s,a)=>{const t=`scale-${s}`;if(!l.has(t)){f(r=>new Set(r).add(t));try{await D.scaleService(s,3),setTimeout(v,1e3)}catch{y.error(`Failed to scale ${a}`)}finally{f(r=>{const n=new Set(r);return n.delete(t),n})}}},Q=async(s,a)=>{const t=`resolve-${s}`;if(!l.has(t)){f(r=>new Set(r).add(t));try{await D.resolveAlert(s,"Resolved via dashboard"),v()}catch{y.error(`Failed to resolve alert: ${a}`)}finally{f(r=>{const n=new Set(r);return n.delete(t),n})}}};if(B)return e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2 mb-6"}),e.jsx("div",{className:"grid grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((s,a)=>e.jsx("div",{className:"h-32 bg-muted rounded"},a))}),e.jsx("div",{className:"h-64 bg-muted rounded"})]})});if(P)return e.jsx("div",{className:"p-6",children:e.jsxs(H,{className:"border-destructive/50 bg-destructive/5",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsxs(F,{children:["Failed to load IT operations data: ",P,". Please check your connection and try again."]})]})});if(!i)return e.jsx("div",{className:"p-6",children:e.jsx(H,{children:e.jsx(F,{children:"No operations data available. Please try refreshing the page."})})});const Z=s=>{switch(s){case"healthy":return"bg-green-500";case"warning":return"bg-yellow-500";case"degraded":return"bg-red-500";default:return"bg-gray-500"}},ee=s=>{switch(s){case"High":return"destructive";case"Medium":return"secondary";case"Low":return"outline";default:return"outline"}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"IT Operations"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor and manage your hybrid cloud infrastructure"})]}),e.jsx(b,{onClick:G,disabled:I,children:I?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"mr-2 h-4 w-4 animate-spin"}),"Running..."]}):"Run Health Check"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(o,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm",children:"Mean Time to Detect"}),e.jsx(te,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:i?.mttd?`${i.mttd.toFixed(1)} min`:"8.2 min"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"-15% from last month"})]})]}),e.jsxs(o,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm",children:"Mean Time to Recover"}),e.jsx(ae,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:i?.mttr?`${i.mttr.toFixed(1)} min`:"24.5 min"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"-8% from last month"})]})]}),e.jsxs(o,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm",children:"System Uptime"}),e.jsx(re,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:i?.uptime?`${i.uptime.toFixed(2)}%`:"99.87%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Target: 99.9%"})]})]}),e.jsxs(o,{children:[e.jsxs(d,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(m,{className:"text-sm",children:"Active Alerts"}),e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(h,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:i?.alerts_count||x.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[x.filter(s=>s.severity==="High").length," High, ",x.filter(s=>s.severity==="Medium").length," Medium"]})]})]})]}),e.jsxs(ne,{defaultValue:"overview",className:"space-y-4",children:[e.jsxs(ie,{children:[e.jsx(S,{value:"overview",children:"Overview"}),e.jsx(S,{value:"performance",children:"Performance"}),e.jsx(S,{value:"incidents",children:"Incidents"}),e.jsx(S,{value:"services",children:"Services"})]}),e.jsx(k,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(o,{children:[e.jsxs(d,{children:[e.jsx(m,{children:"System Performance Overview"}),e.jsx(g,{children:"Real-time resource utilization across all environments"})]}),e.jsx(h,{children:e.jsx(K,{width:"100%",height:300,children:e.jsxs(oe,{data:j,children:[e.jsx(L,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"time"}),e.jsx(_,{}),e.jsx(z,{type:"monotone",dataKey:"cpu",stackId:"1",stroke:"#8884d8",fill:"#8884d8"}),e.jsx(z,{type:"monotone",dataKey:"memory",stackId:"1",stroke:"#82ca9d",fill:"#82ca9d"})]})})})]}),e.jsxs(o,{children:[e.jsxs(d,{children:[e.jsx(m,{children:"Resource Utilization"}),e.jsx(g,{children:"Current usage across critical resources"})]}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"CPU Usage"})]}),e.jsxs("span",{className:"text-sm font-medium",children:[u.cpu,"%"]})]}),e.jsx(C,{value:u.cpu})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Memory Usage"})]}),e.jsxs("span",{className:"text-sm font-medium",children:[u.memory,"%"]})]}),e.jsx(C,{value:u.memory})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Storage Usage"})]}),e.jsxs("span",{className:"text-sm font-medium",children:[u.storage,"%"]})]}),e.jsx(C,{value:u.storage})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Network I/O"})]}),e.jsxs("span",{className:"text-sm font-medium",children:[u.network,"%"]})]}),e.jsx(C,{value:u.network})]})]})]})]})}),e.jsx(k,{value:"performance",className:"space-y-4",children:e.jsxs(o,{children:[e.jsxs(d,{children:[e.jsx(m,{children:"Performance Metrics (24 Hours)"}),e.jsx(g,{children:"Detailed performance monitoring across all systems"})]}),e.jsx(h,{children:e.jsx(K,{width:"100%",height:400,children:e.jsxs(xe,{data:j,children:[e.jsx(L,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"time"}),e.jsx(_,{}),e.jsx(M,{type:"monotone",dataKey:"cpu",stroke:"#8884d8",name:"CPU %"}),e.jsx(M,{type:"monotone",dataKey:"memory",stroke:"#82ca9d",name:"Memory %"}),e.jsx(M,{type:"monotone",dataKey:"disk",stroke:"#ffc658",name:"Disk I/O %"}),e.jsx(M,{type:"monotone",dataKey:"network",stroke:"#ff7300",name:"Network %"})]})})})]})}),e.jsx(k,{value:"incidents",className:"space-y-4",children:e.jsxs(o,{children:[e.jsxs(d,{children:[e.jsx(m,{children:"Recent Incidents"}),e.jsx(g,{children:"Track and manage system incidents"})]}),e.jsx(h,{children:e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{variant:ee(s.severity),children:s.severity}),e.jsx("span",{className:"font-medium",children:s.title})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx("span",{children:s.id}),e.jsxs("span",{children:["Service: ",s.service]}),e.jsx("span",{children:s.created})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{variant:"outline",children:s.status}),s.status==="Active"&&e.jsx(b,{size:"sm",variant:"outline",onClick:()=>Q(s.id,s.title),disabled:l.has(`resolve-${s.id}`),children:l.has(`resolve-${s.id}`)?e.jsx(N,{className:"h-3 w-3 animate-spin"}):"Resolve"})]})]},s.id))})})]})}),e.jsx(k,{value:"services",className:"space-y-4",children:e.jsxs(o,{children:[e.jsxs(d,{children:[e.jsx(m,{children:"Service Health Status"}),e.jsx(g,{children:"Monitor the health of all critical services"})]}),e.jsx(h,{children:e.jsx("div",{className:"space-y-4",children:E.map((s,a)=>{const t=`SVC-${String(a+1).padStart(3,"0")}`;return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${Z(s.status)}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Uptime: ",s.uptime," | Response: ",s.responseTime]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{variant:s.status==="healthy"?"secondary":"destructive",children:s.status}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(b,{size:"sm",variant:"outline",onClick:()=>W(t,s.name),disabled:l.has(`restart-${t}`),children:l.has(`restart-${t}`)?e.jsx(N,{className:"h-3 w-3 animate-spin"}):e.jsx(N,{className:"h-3 w-3"})}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>J(t,s.name),disabled:l.has(`scale-${t}`),children:l.has(`scale-${t}`)?e.jsx(N,{className:"h-3 w-3 animate-spin"}):e.jsx(le,{className:"h-3 w-3"})})]})]})]},a)})})})]})})]})]})}export{be as ITOperations};
