import{r as d,p as Z,a as q,j as e,B as Q,C as r,b as n,c as o,S as V,d as c,T as g,D as K,L,U as ee,A as E,e as se,f as F,g as U,h as u,Z as ae}from"./index-DtNahLzf.js";import{T as te}from"./trending-down-gGEIvF-h.js";import{R as y,C as I,X as O,Y as G,B as b,a as re}from"./generateCategoricalChart-BVheJlJJ.js";import{L as ne,a as N}from"./LineChart-IU27-owU.js";import{B as oe}from"./BarChart-nosETu6r.js";import{P as ce,a as ie}from"./PieChart-jbM2s4do.js";function je(){const[i,w]=d.useState(null),[W,v]=d.useState([]),[H,C]=d.useState([]),[D,k]=d.useState([]),[M,A]=d.useState([]),[J,S]=d.useState(!0);d.useEffect(()=>{T();const s=setInterval(T,12e4);return()=>clearInterval(s)},[]);const T=async()=>{try{const s=`https://${Z}.supabase.co/functions/v1/make-server-efc8e70a`,a={Authorization:`Bearer ${q}`,"Content-Type":"application/json"};try{const m=await fetch(`${s}/metrics/dashboard`,{headers:a});if(m.ok){const t=await m.json();w(t)}else throw new Error("Backend not available");const p=await fetch(`${s}/metrics/performance?hours=7`,{headers:a});if(p.ok){const t=await p.json(),z=[],X=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];for(let j=0;j<7;j++){const l=t.data.filter((B,f)=>Math.floor(f/24)===j);if(l.length>0){const B=l.reduce((h,x)=>h+x.cpu,0)/l.length,f=l.reduce((h,x)=>h+x.memory,0)/l.length,Y=l.reduce((h,x)=>h+x.network,0)/l.length;z.push({name:X[j],cpu:Math.round(B),memory:Math.round(f),network:Math.round(Y)})}}v(z)}const P=await fetch(`${s}/finops/costs`,{headers:a});if(P.ok){const t=await P.json();C(t.data)}const R=await fetch(`${s}/esg/carbon`,{headers:a});if(R.ok){const t=await R.json();k(t.breakdown)}const $=await fetch(`${s}/alerts/current`,{headers:a});if($.ok){const t=await $.json();A(t.alerts.slice(0,2))}}catch(m){console.log("Backend not available, using local data:",m),_()}S(!1)}catch(s){console.error("Error fetching dashboard data:",s),_(),S(!1)}},_=()=>{w({system_health:98.7+(Math.random()-.5)*.4,monthly_spend:285e3+Math.floor((Math.random()-.5)*2e4),carbon_footprint:42.3+(Math.random()-.5)*2,active_projects:24,uptime:99.87,mttd:8.2,mttr:24.5,alerts_count:3});const a=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(p=>({name:p,cpu:65+Math.floor(Math.random()*20),memory:68+Math.floor(Math.random()*15),network:45+Math.floor(Math.random()*10)}));v(a),C([{month:"Jan",aws:125e3,azure:87e3,gcp:45e3},{month:"Feb",aws:132e3,azure:91e3,gcp:48e3},{month:"Mar",aws:128e3,azure:89e3,gcp:46e3},{month:"Apr",aws:135e3,azure:94e3,gcp:51e3},{month:"May",aws:142e3,azure:97e3,gcp:53e3},{month:"Jun",aws:138e3,azure:95e3,gcp:52e3}]),k([{name:"Computing",value:45,color:"#8884d8"},{name:"Storage",value:25,color:"#82ca9d"},{name:"Network",value:20,color:"#ffc658"},{name:"Other",value:10,color:"#ff7300"}]),A([{id:"ALT-001",title:"Database Connection Pool Exhaustion",description:"Payment processing database showing connection pool exhaustion. Response times increased by 300%."},{id:"ALT-002",title:"Memory Usage Threshold Exceeded",description:"Web frontend instances consistently above 85% memory utilization."}])};return J?e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-6"}),e.jsx("div",{className:"grid grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((s,a)=>e.jsx("div",{className:"h-32 bg-gray-200 rounded"},a))})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"IT Operations Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Unified view of your hybrid cloud infrastructure"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Q,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"All Systems Operational"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(r,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm",children:"System Health"}),e.jsx(V,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:i?.system_health?`${i.system_health.toFixed(1)}%`:"98.7%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:e.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3"}),"+0.3% from last month"]})})]})]}),e.jsxs(r,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm",children:"Monthly Cloud Spend"}),e.jsx(K,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-2xl font-semibold",children:["$",i?.monthly_spend?i.monthly_spend.toLocaleString():"285,000"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:e.jsxs("span",{className:"text-red-600 flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3"}),"+8.2% from last month"]})})]})]}),e.jsxs(r,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm",children:"Carbon Footprint"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:i?.carbon_footprint?`${i.carbon_footprint.toFixed(1)} tCO₂`:"42.3 tCO₂"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:e.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"}),"-12% from last month"]})})]})]}),e.jsxs(r,{children:[e.jsxs(n,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(o,{className:"text-sm",children:"Active Projects"}),e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:i?.active_projects||24}),e.jsx("p",{className:"text-xs text-muted-foreground",children:e.jsxs("span",{className:"text-green-600 flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3"}),"+3 new this week"]})})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[M.map(s=>e.jsxs(E,{children:[e.jsx(se,{className:"h-4 w-4"}),e.jsxs(F,{children:[e.jsxs("span",{className:"font-medium",children:[s.title,":"]})," ",s.description]})]},s.id)),M.length===0&&e.jsxs(E,{children:[e.jsx(U,{className:"h-4 w-4"}),e.jsxs(F,{children:[e.jsx("span",{className:"font-medium",children:"AI Insight:"})," All systems operating normally. Predictive models show stable performance expected."]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(o,{children:"System Performance (7 Days)"}),e.jsx(u,{children:"CPU, Memory, and Network utilization trends"})]}),e.jsx(c,{children:e.jsx(y,{width:"100%",height:300,children:e.jsxs(ne,{data:W,children:[e.jsx(I,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"name"}),e.jsx(G,{}),e.jsx(N,{type:"monotone",dataKey:"cpu",stroke:"#8884d8",name:"CPU %"}),e.jsx(N,{type:"monotone",dataKey:"memory",stroke:"#82ca9d",name:"Memory %"}),e.jsx(N,{type:"monotone",dataKey:"network",stroke:"#ffc658",name:"Network %"})]})})})]}),e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(o,{children:"Cloud Spend by Provider"}),e.jsx(u,{children:"Monthly cost breakdown across cloud providers"})]}),e.jsx(c,{children:e.jsx(y,{width:"100%",height:300,children:e.jsxs(oe,{data:H,children:[e.jsx(I,{strokeDasharray:"3 3"}),e.jsx(O,{dataKey:"month"}),e.jsx(G,{}),e.jsx(b,{dataKey:"aws",fill:"#8884d8",name:"AWS"}),e.jsx(b,{dataKey:"azure",fill:"#82ca9d",name:"Azure"}),e.jsx(b,{dataKey:"gcp",fill:"#ffc658",name:"GCP"})]})})})]}),e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(o,{children:"Carbon Footprint Distribution"}),e.jsx(u,{children:"CO₂ emissions by service category"})]}),e.jsx(c,{children:e.jsx(y,{width:"100%",height:300,children:e.jsx(ce,{children:e.jsx(ie,{data:D,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",label:s=>`${s.name}: ${s.value}%`,children:D.map((s,a)=>e.jsx(re,{fill:s.color},`cell-${a}`))})})})})]}),e.jsxs(r,{children:[e.jsxs(n,{children:[e.jsx(o,{children:"Quick Actions"}),e.jsx(u,{children:"Frequently used operations"})]}),e.jsx(c,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg cursor-pointer hover:bg-accent transition-colors",children:[e.jsx(ae,{className:"w-5 h-5 mb-2 text-blue-600"}),e.jsx("p",{className:"font-medium text-sm",children:"Scale Resources"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Auto-scale based on demand"})]}),e.jsxs("div",{className:"p-3 border rounded-lg cursor-pointer hover:bg-accent transition-colors",children:[e.jsx(K,{className:"w-5 h-5 mb-2 text-green-600"}),e.jsx("p",{className:"font-medium text-sm",children:"Cost Analysis"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Generate cost report"})]}),e.jsxs("div",{className:"p-3 border rounded-lg cursor-pointer hover:bg-accent transition-colors",children:[e.jsx(L,{className:"w-5 h-5 mb-2 text-green-600"}),e.jsx("p",{className:"font-medium text-sm",children:"ESG Report"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Download sustainability metrics"})]}),e.jsxs("div",{className:"p-3 border rounded-lg cursor-pointer hover:bg-accent transition-colors",children:[e.jsx(U,{className:"w-5 h-5 mb-2 text-purple-600"}),e.jsx("p",{className:"font-medium text-sm",children:"AI Recommendations"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Get optimization insights"})]})]})})]})]})]})}export{je as Dashboard};
