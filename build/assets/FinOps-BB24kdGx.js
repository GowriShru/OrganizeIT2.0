import{i as W,r as x,j as e,A as E,e as B,f as _,l as z,E as Z,C as l,b as c,c as d,D as ee,d as m,T as se,o as te,q as ae,s as N,t as b,h as g,B as A,P as ne}from"./index-DtNahLzf.js";import{e as ie,f as re}from"./api-CnfHayjd.js";import{t as u}from"./index-BR4xEgPS.js";import{R as D}from"./rotate-ccw-TK-3Ba20.js";import{T as G}from"./trending-down-gGEIvF-h.js";import{T as oe}from"./target-BKHSCHFY.js";import{C as le}from"./chart-column-CkzR7tKl.js";import{R as F,a as ce,C as R,X as K,Y as H}from"./generateCategoricalChart-BVheJlJJ.js";import{P as de,a as me}from"./PieChart-jbM2s4do.js";import{A as he,a as P}from"./AreaChart-TKF-TF37.js";import{L as xe,a as C}from"./LineChart-IU27-owU.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],U=W("calculator",pe);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],ue=W("play",ge),je=()=>{const a=[],j=new Date;for(let r=5;r>=0;r--){const f=new Date(j.getFullYear(),j.getMonth()-r,1),S=f.toLocaleString("default",{month:"short"}),h={aws:125e3+(5-r)*2e3,azure:87e3+(5-r)*1500,gcp:45e3+(5-r)*1e3};a.push({month:S,date:f.toISOString(),aws:h.aws+Math.floor((Math.random()-.5)*1e4),azure:h.azure+Math.floor((Math.random()-.5)*8e3),gcp:h.gcp+Math.floor((Math.random()-.5)*5e3),total:h.aws+h.azure+h.gcp})}return a};function Fe(){const[a,j]=x.useState([]),[r,f]=x.useState(null),[S,h]=x.useState(!0),[O,T]=x.useState(null),[p,M]=x.useState(null),[y,v]=x.useState(!1),[k,I]=x.useState(new Set);x.useEffect(()=>{const s=async()=>{try{T(null);let t={costs:je(),optimization:[{id:"OPT-001",title:"Right-size EC2 Instances",description:"23 EC2 instances are oversized based on actual usage patterns",potential_savings:24e3,effort:"Low",impact:"High"}],summary:{potential_savings:67500}};try{const n="http://localhost:8080/api",o={"Content-Type":"application/json"},w=await fetch(`${n}/finops`,{headers:o});w.ok?(t=(await w.json()).data,console.log("✓ Successfully fetched FinOps data from API server")):console.log("⚠️ API server not responding, using fallback FinOps data")}catch{console.log("⚠️ API server not available for FinOps data, using fallback. Start server with: npm run server")}if(j(t.costs),f({opportunities:t.optimization,total_savings:t.summary.potential_savings}),t.costs.length>0){const n=t.costs[t.costs.length-1]||{total:285e3},o=t.costs[t.costs.length-2]||{total:262e3},w=o&&o.total>0?(n.total-o.total)/o.total*100:8.3;M({monthlySpend:n.total||285e3,monthlyGrowth:w,potentialSavings:t.summary?.potential_savings||67500,budgetUtilization:Math.round((n.total||285e3)/4e5*100),costPerGB:.42-Math.random()*.1})}else M({monthlySpend:285e3,monthlyGrowth:8.3,potentialSavings:67500,budgetUtilization:71,costPerGB:.42})}catch(t){console.error("Error fetching FinOps data:",t),T(t.message)}finally{h(!1)}};s();const i=setInterval(s,3e5);return()=>clearInterval(i)},[]);const $=a.length>0?[{category:"AWS",amount:a[a.length-1]?.aws||0,color:"#FF9900"},{category:"Azure",amount:a[a.length-1]?.azure||0,color:"#0078D4"},{category:"GCP",amount:a[a.length-1]?.gcp||0,color:"#4285F4"}].filter(s=>s.amount>0):[],Y=a.length>0?[{service:"AWS Production",budget:15e4,spent:a[a.length-1]?.aws||0,status:"warning"},{service:"Azure Development",budget:1e5,spent:a[a.length-1]?.azure||0,status:"healthy"},{service:"GCP Analytics",budget:6e4,spent:a[a.length-1]?.gcp||0,status:"warning"}]:[],L=a,X=r?.opportunities||r?.optimization||[{id:"OPT-001",title:"Right-size EC2 Instances",description:"23 EC2 instances are oversized based on actual usage patterns",potentialSaving:24e3,potential_savings:24e3,effort:"Low",impact:"High"},{id:"OPT-002",title:"Reserved Instance Optimization",description:"Purchase reserved instances for consistent workloads",potentialSaving:35e3,potential_savings:35e3,effort:"Medium",impact:"High"}],q=(s,i)=>{const t=s/i*100;return t>=90?"danger":t>=75?"warning":"healthy"},V=async()=>{v(!0);try{await ie.exportData("finops","pdf",{start:new Date(Date.now()-720*60*60*1e3).toISOString(),end:new Date().toISOString()})}catch{u.error("Failed to export report")}finally{v(!1)}},J=async()=>{v(!0);try{await new Promise(s=>setTimeout(s,2e3)),u.success("Cost analysis completed successfully")}catch{u.error("Cost analysis failed")}finally{v(!1)}},Q=async(s,i)=>{const t=`implement-${s}`;if(!k.has(t)){I(n=>new Set(n).add(t));try{await re.applyOptimization(s),setTimeout(()=>{u.success(`${i} implementation started`)},1e3)}catch{u.error(`Failed to implement: ${i}`)}finally{I(n=>{const o=new Set(n);return o.delete(t),o})}}};return S?e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2 mb-6"}),e.jsx("div",{className:"grid grid-cols-4 gap-6 mb-6",children:[...Array(4)].map((s,i)=>e.jsx("div",{className:"h-32 bg-muted rounded"},i))}),e.jsx("div",{className:"h-64 bg-muted rounded"})]})}):O?e.jsx("div",{className:"p-6",children:e.jsxs(E,{className:"border-destructive/50 bg-destructive/5",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsxs(_,{children:["Failed to load FinOps data: ",O,". Please check your connection and try again."]})]})}):p?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"FinOps Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Financial operations and cloud cost optimization"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{variant:"outline",onClick:V,disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Export Report"]})}),e.jsx(z,{onClick:J,disabled:y,children:y?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"mr-2 h-4 w-4"}),"Cost Analysis"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm",children:"Monthly Spend"}),e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsxs("div",{className:"text-2xl font-semibold",children:["$",(p?.monthlySpend||285e3).toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:(p?.monthlyGrowth||8.3)>=0?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-3 h-3 text-red-600"}),e.jsxs("span",{className:"text-red-600",children:["+",(p?.monthlyGrowth||8.3).toFixed(1),"% from last month"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-3 h-3 text-green-600"}),e.jsxs("span",{className:"text-green-600",children:[(p?.monthlyGrowth||-2.5).toFixed(1),"% from last month"]})]})})]})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm",children:"Potential Savings"}),e.jsx(oe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:"$67,500"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"23.7% cost reduction opportunity"})]})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm",children:"Budget Utilization"}),e.jsx(le,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:"84.2%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"of monthly budget consumed"})]})]}),e.jsxs(l,{children:[e.jsxs(c,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(d,{className:"text-sm",children:"Cost per GB"}),e.jsx(U,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:"$0.42"}),e.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(G,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"text-green-600",children:"-5% optimization"})]})]})]})]}),e.jsxs(te,{defaultValue:"overview",className:"space-y-4",children:[e.jsxs(ae,{children:[e.jsx(N,{value:"overview",children:"Overview"}),e.jsx(N,{value:"trends",children:"Cost Trends"}),e.jsx(N,{value:"optimization",children:"Optimization"}),e.jsx(N,{value:"budgets",children:"Budgets"})]}),e.jsx(b,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Cost Breakdown by Service"}),e.jsx(g,{children:"Distribution of cloud spending across service categories"})]}),e.jsx(m,{children:e.jsx(F,{width:"100%",height:300,children:e.jsx(de,{children:e.jsx(me,{data:$,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"amount",label:s=>`${s.category}: $${(s.amount/1e3).toFixed(0)}k`,children:$.map((s,i)=>e.jsx(ce,{fill:s.color},`cell-${i}`))})})})})]}),e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Monthly Spend by Provider"}),e.jsx(g,{children:"6-month trend across cloud providers"})]}),e.jsx(m,{children:e.jsx(F,{width:"100%",height:300,children:e.jsxs(he,{data:L,children:[e.jsx(R,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"month"}),e.jsx(H,{}),e.jsx(P,{type:"monotone",dataKey:"aws",stackId:"1",stroke:"#8884d8",fill:"#8884d8"}),e.jsx(P,{type:"monotone",dataKey:"azure",stackId:"1",stroke:"#82ca9d",fill:"#82ca9d"}),e.jsx(P,{type:"monotone",dataKey:"gcp",stackId:"1",stroke:"#ffc658",fill:"#ffc658"})]})})})]})]})}),e.jsx(b,{value:"trends",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Cost Trends Analysis"}),e.jsx(g,{children:"Detailed cost analysis over the past 6 months"})]}),e.jsx(m,{children:e.jsx(F,{width:"100%",height:400,children:e.jsxs(xe,{data:L,children:[e.jsx(R,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"month"}),e.jsx(H,{}),e.jsx(C,{type:"monotone",dataKey:"total",stroke:"#8884d8",strokeWidth:3,name:"Total"}),e.jsx(C,{type:"monotone",dataKey:"aws",stroke:"#82ca9d",name:"AWS"}),e.jsx(C,{type:"monotone",dataKey:"azure",stroke:"#ffc658",name:"Azure"}),e.jsx(C,{type:"monotone",dataKey:"gcp",stroke:"#ff7300",name:"GCP"})]})})})]})}),e.jsx(b,{value:"optimization",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Cost Optimization Opportunities"}),e.jsx(g,{children:"AI-identified savings opportunities ranked by impact"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-4",children:X.map((s,i)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium",children:s.title}),e.jsxs(A,{variant:s.impact==="High"?"default":"secondary",children:[s.impact," Impact"]}),e.jsxs(A,{variant:"outline",children:[s.effort," Effort"]})]}),e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:["$",(s.potentialSaving||s.potential_savings||0).toLocaleString(),"/month"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),e.jsx(z,{size:"sm",className:"mt-2",onClick:()=>Q(s.id||`OPT-${Date.now()}`,s.title),disabled:k.has(`implement-${s.id||"default"}`),children:k.has(`implement-${s.id||"default"}`)?e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"mr-1 h-3 w-3 animate-spin"}),"Implementing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"mr-1 h-3 w-3"}),"Implement"]})})]},i))})})]})}),e.jsx(b,{value:"budgets",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Budget Monitoring"}),e.jsx(g,{children:"Track spending against allocated budgets"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-6",children:Y.map((s,i)=>{const t=s.budget>0?(s.spent||0)/s.budget*100:0,n=q(s.spent,s.budget);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-medium",children:s.service}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm",children:["$",(s.spent||0).toLocaleString()," / $",(s.budget||0).toLocaleString()]}),e.jsxs(A,{variant:n==="healthy"||n==="warning"?"secondary":"destructive",children:[t.toFixed(1),"%"]})]})]}),e.jsx(ne,{value:t,className:`h-2 ${n==="danger"?"bg-red-100":n==="warning"?"bg-yellow-100":"bg-green-100"}`}),t>=90&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600",children:[e.jsx(B,{className:"w-4 h-4"}),"Budget threshold exceeded"]})]},i)})})})]})})]})]}):e.jsx("div",{className:"p-6",children:e.jsx(E,{children:e.jsx(_,{children:"No financial data available. Please try refreshing the page."})})})}export{Fe as FinOps};
