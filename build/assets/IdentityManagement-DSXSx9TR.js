import{i as w,r as S,j as e,l as d,C as a,b as t,c as r,U as D,d as i,u,o as A,q as C,s as m,t as x,H as M,I as U,B as c,h as j,e as k,P as T,K as L,x as I}from"./index-DtNahLzf.js";import{i as p}from"./api-CnfHayjd.js";import{L as E}from"./lock-20m6CtwN.js";import{U as P}from"./user-check-CSBcGiis.js";import"./index-BR4xEgPS.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],V=w("fingerprint",F),B=[{id:"USR-001",name:"Alice Johnson",email:"alice.johnson@company.com",role:"Senior DevOps Engineer",status:"Active",lastLogin:"2024-07-22T10:30:00Z",mfaEnabled:!0,permissions:["Admin","Deploy","Monitor"],devices:3},{id:"USR-002",name:"Bob Smith",email:"bob.smith@company.com",role:"Cloud Architect",status:"Active",lastLogin:"2024-07-22T09:15:00Z",mfaEnabled:!0,permissions:["Deploy","Monitor","Configure"],devices:2},{id:"USR-003",name:"Carol Davis",email:"carol.davis@company.com",role:"Security Specialist",status:"Inactive",lastLogin:"2024-07-20T16:45:00Z",mfaEnabled:!1,permissions:["Security","Audit","Monitor"],devices:1}],R=[{id:"DID-001",holder:"Alice Johnson",credentialType:"Professional Certification",issuer:"AWS",issuedDate:"2024-01-15",expiryDate:"2026-01-15",status:"Valid",verificationStatus:"Verified"},{id:"DID-002",holder:"Bob Smith",credentialType:"Security Clearance",issuer:"Internal Security",issuedDate:"2024-03-20",expiryDate:"2025-03-20",status:"Valid",verificationStatus:"Verified"},{id:"DID-003",holder:"Carol Davis",credentialType:"Compliance Training",issuer:"ComplianceOrg",issuedDate:"2024-02-10",expiryDate:"2024-08-10",status:"Expiring Soon",verificationStatus:"Verified"}],Z=[{id:"LOG-001",user:"Alice Johnson",action:"Login",resource:"Production Environment",timestamp:"2024-07-22T10:30:15Z",ip:"192.168.1.100",device:"MacBook Pro",status:"Success"},{id:"LOG-002",user:"Bob Smith",action:"Deploy",resource:"Staging Environment",timestamp:"2024-07-22T09:15:22Z",ip:"192.168.1.101",device:"Windows Laptop",status:"Success"},{id:"LOG-003",user:"Unknown",action:"Failed Login",resource:"Admin Panel",timestamp:"2024-07-22T08:45:33Z",ip:"203.0.113.45",device:"Unknown",status:"Blocked"}],z=[{metric:"MFA Adoption",value:87,target:100,unit:"%"},{metric:"Password Strength",value:92,target:95,unit:"%"},{metric:"Session Security",value:96,target:98,unit:"%"},{metric:"Device Trust",value:89,target:90,unit:"%"}];function J(){const[v,l]=S.useState(!1),N=async()=>{l(!0);try{await p.exportUsers("csv",{active_only:!1},!1)}catch(s){console.error("Failed to export users:",s)}finally{l(!1)}},y=async()=>{l(!0);try{await p.addUser({name:"New User",email:"newuser@organizeit.com",role:"User",permissions:["Monitor"],send_invite:!0})}catch(s){console.error("Failed to add user:",s)}finally{l(!1)}},b=async(s,n)=>{try{await p.manageUser(s,"update_permissions",{permissions:["Admin","Deploy","Monitor"],status:"Active"})}catch(h){console.error("Failed to manage user:",h)}},o=s=>{switch(s){case"Active":case"Valid":case"Success":case"Verified":return"secondary";case"Inactive":case"Blocked":case"Invalid":return"destructive";case"Suspended":case"Expiring Soon":case"Pending":return"secondary";default:return"outline"}},f=s=>new Date(s).toLocaleDateString(),g=s=>new Date(s).toLocaleString();return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Identity Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Decentralized identity and access control"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"outline",onClick:N,disabled:v,children:"Export Users"}),e.jsx(d,{onClick:y,disabled:v,children:"Add User"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(a,{children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm",children:"Total Users"}),e.jsx(D,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:"1,247"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+23 new this month"})]})]}),e.jsxs(a,{children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm",children:"Active Sessions"}),e.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:"342"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all platforms"})]})]}),e.jsxs(a,{children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm",children:"DID Credentials"}),e.jsx(V,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:"456"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"12 expiring soon"})]})]}),e.jsxs(a,{children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm",children:"Security Score"}),e.jsx(u,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-semibold",children:"91%"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Above industry average"})]})]})]}),e.jsxs(A,{defaultValue:"users",className:"space-y-4",children:[e.jsxs(C,{children:[e.jsx(m,{value:"users",children:"Users"}),e.jsx(m,{value:"credentials",children:"DID Credentials"}),e.jsx(m,{value:"access",children:"Access Logs"}),e.jsx(m,{value:"security",children:"Security"})]}),e.jsx(x,{value:"users",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:B.map(s=>e.jsx(a,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(M,{children:e.jsx(U,{children:s.name.split(" ").map(n=>n[0]).join("")})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx(c,{variant:o(s.status),children:s.status}),s.mfaEnabled&&e.jsxs(c,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(u,{className:"w-3 h-3"}),"MFA"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx("span",{children:s.email}),e.jsx("span",{children:s.role}),e.jsxs("span",{children:["Last login: ",g(s.lastLogin)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Permissions:"}),e.jsx("div",{className:"flex gap-1",children:s.permissions.map((n,h)=>e.jsx(c,{variant:"outline",className:"text-xs",children:n},h))})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:[e.jsxs("div",{children:[s.devices," devices"]}),e.jsx("div",{children:s.id})]}),e.jsx(d,{size:"sm",variant:"outline",onClick:()=>b(s.id,s.name),children:"Manage"})]})]})})},s.id))})}),e.jsx(x,{value:"credentials",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:R.map(s=>e.jsx(a,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium",children:s.credentialType}),e.jsx(c,{variant:o(s.status),children:s.status}),e.jsx(c,{variant:o(s.verificationStatus),children:s.verificationStatus})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Holder"}),e.jsx("div",{children:s.holder})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Issuer"}),e.jsx("div",{children:s.issuer})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Issued"}),e.jsx("div",{children:f(s.issuedDate)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:"Expires"}),e.jsx("div",{children:f(s.expiryDate)})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{size:"sm",variant:"outline",children:"Verify"}),e.jsx(d,{size:"sm",variant:"outline",children:"Renew"})]})]})})},s.id))})}),e.jsx(x,{value:"access",className:"space-y-4",children:e.jsxs(a,{children:[e.jsxs(t,{children:[e.jsx(r,{children:"Recent Access Logs"}),e.jsx(j,{children:"User activity and access attempts"})]}),e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:Z.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"font-medium",children:s.user}),e.jsx(c,{variant:o(s.status),children:s.status}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.action})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsx("span",{children:s.resource}),e.jsxs("span",{children:["IP: ",s.ip]}),e.jsxs("span",{children:["Device: ",s.device]}),e.jsx("span",{children:g(s.timestamp)})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:s.status==="Success"?e.jsx(P,{className:"w-5 h-5 text-green-600"}):e.jsx(k,{className:"w-5 h-5 text-red-600"})})]},s.id))})})]})}),e.jsx(x,{value:"security",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(a,{children:[e.jsxs(t,{children:[e.jsx(r,{children:"Security Metrics"}),e.jsx(j,{children:"Identity and access security indicators"})]}),e.jsx(i,{className:"space-y-6",children:z.map((s,n)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:s.metric}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.value,s.unit," / ",s.target,s.unit]})]}),e.jsx(T,{value:s.value/s.target*100})]},n))})]}),e.jsxs(a,{children:[e.jsxs(t,{children:[e.jsx(r,{children:"Security Recommendations"}),e.jsx(j,{children:"AI-driven security improvements"})]}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(u,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Enable MFA for All Users"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"13% of users don't have MFA enabled. Enforce MFA for enhanced security."})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(L,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{className:"font-medium",children:"Password Policy Update"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"8% of passwords don't meet current strength requirements."})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(I,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"font-medium",children:"Session Timeout Review"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Consider reducing session timeout for privileged accounts."})]})]})]})]})})]})]})}export{J as IdentityManagement};
